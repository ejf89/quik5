import fetch from 'node-fetch'
var $ = require('jquery');
var Airtable = require('airtable')



console.log(AIRTABLE_KEY);
console.log('KEYCHECK');

const AIRTABLE_KEY = process.env.AIRTABLE_KEY
// var base = new Airtable({apiKey: 'key88K3RNIPwV1AgS'}).base('appLSROdM7sAWo7Xc');
var base = new Airtable({apiKey: AIRTABLE_KEY}).base('appLSROdM7sAWo7Xc');



export async function masterFetch(store_url, product_handle){
  console.log(product_handle);
  console.log(window.location.ancestorOrigins);

  if (!store_url) {
    var store_url = window.location.ancestorOrigins[0].replace('.myshopify.com', '').split('//')[1]
    console.log(store_url);
  } else {
    console.log('there');
    console.log(store_url);
  }

  var settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://api.zeit.co/v2/now/deployments?teamId=team_Ayjtm3wiLicR7VxJOhbAcUMA",
  "method": "POST",
  "headers": {
    "Authorization": "Bearer lc874d1V2GLvXdppHIpcOnj1",
    "Content-Type": "application/json"
  },
  "processData": false,
  "data": `{\n  \"name\": \"my-instant-deployment\",\n  \"version\": 2,\n  \"files\": [\n  {\n    \"file\": \"./package.json\",\n    \"data\": \"{\\r\\n  \\\"name\\\": \\\"app3\\\",\\r\\n  \\\"version\\\": \\\"1.0.0\\\",\\r\\n  \\\"description\\\": \\\"\\\",\\r\\n  \\\"scripts\\\": {\\r\\n    \\\"start\\\": \\\"serve\\\"\\r\\n  },\\r\\n  \\\"now\\\": {\\r\\n    \\\"version\\\": 2,\\r\\n    \\\"env\\\": {\\r\\n      \\\"STORE_LINK\\\": \\\"${store_url}\\\",\\r\\n      \\\"PRODUCT_HANDLE\\\": \\\"${product_handle}\\\"\\r\\n    },\\r\\n    \\\"builds\\\": [\\r\\n      {\\r\\n        \\\"src\\\": \\\"index.html\\\",\\r\\n        \\\"use\\\": \\\"@now\\/static\\\"\\r\\n      },\\r\\n      {\\r\\n        \\\"src\\\": \\\"*.css\\\",\\r\\n        \\\"use\\\": \\\"@now\\/static\\\"\\r\\n      },\\r\\n      {\\r\\n        \\\"src\\\": \\\"*.js\\\",\\r\\n        \\\"use\\\": \\\"@now\\/static\\\"\\r\\n      },\\r\\n      {\\r\\n        \\\"use\\\": \\\"@now\\/static\\\"\\r\\n      }\\r\\n    ],\\r\\n    \\\"routes\\\": [\\r\\n      {\\r\\n        \\\"src\\\": \\\"\\/\\\",\\r\\n        \\\"dest\\\": \\\"\\/\\\"\\r\\n      }\\r\\n    ],\\r\\n    \\\"public\\\": true\\r\\n  },\\r\\n  \\\"dependencies\\\": {\\r\\n    \\\"now-env\\\": \\\"^3.1.0\\\",\\r\\n    \\\"require\\\": \\\"^2.4.20\\\",\\r\\n    \\\"serve\\\": \\\"^10.1.1\\\"\\r\\n  }\\r\\n}\\r\\n\"\n    },\n    {\n      \"file\": \"index.html\",\n      \"data\": \"PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiIgZGlyPSJsdHIiPg0KICA8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+DQogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzMuMy4xL2pxdWVyeS5taW4uanMiPjwvc2NyaXB0Pg0KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL3VucGtnLmNvbS9mbGlja2l0eUAyL2Rpc3QvZmxpY2tpdHkucGtnZC5taW4uanMiPjwvc2NyaXB0Pg0KDQogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vdnVlIj48L3NjcmlwdD4NCg0KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly91bnBrZy5jb20vZmxpY2tpdHlAMi9kaXN0L2ZsaWNraXR5Lm1pbi5jc3MiPg0KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iYmlzbXV0aC5jc3MiPg0KDQogIDwvaGVhZD4NCiAgPGJvZHk+DQoNCiAgICA8ZGl2IGlkPSJhcHAiPg0KDQogICAgICA8ZGl2IGNsYXNzPSJwcm9kdWN0LWNvbnRhaW5lciI+DQoNCiAgICAgICAgPGRpdiBjbGFzcz0icHJvZHVjdC1oYW5kbGUiPg0KICAgICAgICAgIHt7IHByb2R1Y3RfaGFuZGxlIH19DQogICAgICAgIDwvZGl2Pg0KDQogICAgICAgIDxkaXYgY2xhc3M9InNsaWRlciI+DQogICAgICAgICAgPGltZyBjbGFzcz0icHJvZHVjdC1pbWFnZSIgdi1mb3I9ImltYWdlIGluIHByb2R1Y3RfaW1hZ2VzIg0KICAgICAgICAgIHYtYmluZDpzcmM9ImltYWdlLnNyYyIgYWx0PSIiPjwvaW1nPg0KICAgICAgICA8L2Rpdj4NCg0KICAgICAgICA8ZGl2IGNsYXNzPSJob3Jpem9udGFsLWNvbnRhaW5lciI+DQogICAgICAgICAgPGRpdiBjbGFzcz0icHJpY2UiPg0KICAgICAgICAgICAge3sgcHJvZHVjdF9wcmljZSB9fQ0KICAgICAgICAgIDwvZGl2Pg0KDQogICAgICAgICAgPHNlbGVjdCBjbGFzcz0icXVhbnRpdHkiPiBRdWFudGl0eQ0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMSI+MTwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMiI+Mjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMyI+Mzwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNCI+NDwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNSI+NTwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNiI+Njwvb3B0aW9uPg0KICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICA8L2Rpdj4NCg0KDQoNCiAgICAgICAgPGRpdiBjbGFzcz0icHJvZHVjdC1kZXNjcmlwdGlvbiI+DQogICAgICAgICAge3sgcHJvZHVjdF9kZXNjcmlwdGlvbiB9fQ0KICAgICAgICA8L2Rpdj4NCg0KDQogICAgICAgIDxkaXYgY2xhc3M9ImJvdHRvbS1jb250YWluZXIiPg0KDQogICAgICAgICAgPGRpdiBjbGFzcz0ib3B0aW9uLXBhcmVudC1jb250YWluZXIiIHYtaWY9Im9wdGlvbnMubGVuZ3RoID4gMCI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJvcHRpb24iIHYtZm9yPSJvcHRpb24gaW4gb3B0aW9ucyI+DQogICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9Im9wdGlvbi1zZWxlY3QiIHYtYmluZDppZD0ib3B0aW9uLm5hbWUiIHYtYmluZDpuYW1lPSJvcHRpb24ubmFtZSI+DQogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj57eyBvcHRpb24ubmFtZSB9fTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgIDxvcHRpb24gdi1mb3I9InZhbHVlIGluIG9wdGlvbi52YWx1ZXMiIHYtYmluZC52YWx1ZT0idmFsdWUiPnt7IHZhbHVlIH19PC9vcHRpb24+DQoNCiAgICAgICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICA8L2Rpdj4NCg0KDQogICAgICAgICAgPGRpdiBjbGFzcz0iY2hlY2tvdXQiIHYtb246Y2xpY2s9InNlbmRDYXJ0KCkiPg0KICAgICAgICAgICAgQ2hlY2tvdXQNCiAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQoNCg0KDQogICAgICA8L2Rpdj4NCjwvZGl2Pg0KDQogICAgPHNjcmlwdCBzcmM9ImluZGV4LmpzIj48L3NjcmlwdD4NCg0KICA8L2JvZHk+DQo8L2h0bWw+\",\n      \"encoding\": \"base64\"\n    },\n    {\n      \"file\": \"index.js\",\n      \"data\": \"KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9ImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitpKyInIik7dGhyb3cgYS5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9ImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKCgoKLy8gcmVxdWlyZShbJ25vdy1lbnYnXSwgZnVuY3Rpb24oKXsKLy8gICBjb25zb2xlLmxvZygiTE9BREVEIik7Ci8vIH0pCnZhciBwYWNrYWdlOwp2YXIgc3RvcmVfbGluazsKdmFyIHByb2R1Y3RfaGFuZGxlOwogJC5hamF4KHsKICBkYXRhVHlwZTogImpzb24iLAogIHVybDogJ3BhY2thZ2UuanNvbicsCiAgc3VjY2VzczogZnVuY3Rpb24ocmVzKXsKICAgIHBhY2thZ2UgPSByZXMKICAgIGNvbnNvbGUubG9nKHJlcykKCiAgICAgc3RvcmVfbGluayA9IHBhY2thZ2Uubm93LmVudi5TVE9SRV9MSU5LCiAgICAgcHJvZHVjdF9oYW5kbGUgPSBwYWNrYWdlLm5vdy5lbnYuUFJPRFVDVF9IQU5ETEUKICB9Cn0pLnRoZW4oICgpID0+IHsKCiAgY29uc29sZS5sb2coIkxJTksiKTsKICBjb25zb2xlLmxvZyhzdG9yZV9saW5rKTsKCiAgY29uc29sZS5sb2coIkhBTkRMRSIpOwogIGNvbnNvbGUubG9nKHByb2R1Y3RfaGFuZGxlKTsKCiAgbGV0IHZtID0gbmV3IFZ1ZSh7CiAgICBlbDogJyNhcHAnLAogICAgZGF0YTogewogICAgICBjYXJ0X3VybDogYGh0dHBzOi8vJHtzdG9yZV9saW5rfS5teXNob3BpZnkuY29tL2NhcnRgLAogICAgICBwcm9kdWN0X2hhbmRsZTogJycsCiAgICAgIG1lc3NhZ2U6ICdWdWUgaXMgd29ya2luZyEnLAogICAgICBwcm9kdWN0X2RhdGE6IHt9LAogICAgICBwcm9kdWN0X2ltYWdlczogW10sCiAgICAgIHByb2R1Y3RfcHJpY2U6ICcnLAogICAgICB2YXJpYW50czogW10sCiAgICAgIG9wdGlvbnM6IFtdLAogICAgICBwcm9kdWN0X2Rlc2NyaXB0aW9uOiAnJwoKICAgIH0sCiAgICBjcmVhdGVkOiBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnNvbGUubG9nKCJDUkVBVEVEIik7CgogICAgICB0aGlzLmdldERhdGEoKQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgdXBkYXRlRGF0YTogZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMubWVzc2FnZSA9ICd1cGRhdGVkJwogICAgICB9LAogICAgICBnZXREYXRhOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgJC5hamF4KCB7CiAgICAgICAgICB1cmw6IGBodHRwczovLyR7c3RvcmVfbGlua30ubXlzaG9waWZ5LmNvbS9wcm9kdWN0cy8ke3Byb2R1Y3RfaGFuZGxlfS5qc29uYCwKICAgICAgICAgIHR5cGU6ICdHRVQnLAogICAgICAgICAgZGF0YVR5cGU6ICJqc29ucCIsCiAgICAgICAgICBzdWNjZXNzOiAoZGF0YSkgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZygiR09UIFNUT1JFIERBVEEiKTsKICAgICAgICAgICAgdGhpcy5wcm9kdWN0X2RhdGEgPSBPYmplY3QuYXNzaWduKHRoaXMucHJvZHVjdF9kYXRhLCBkYXRhLnByb2R1Y3QpCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMucHJvZHVjdF9kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC50aGVuKCAoKSA9PiB7CiAgICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbigpewogICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSAidXBkYXRlZCIKICAgICAgICAgICAgdGhpcy5wcm9kdWN0X2hhbmRsZSA9IHRoaXMucHJvZHVjdF9kYXRhLnRpdGxlCiAgICAgICAgICAgIHRoaXMudmFyaWFudHMgPSB0aGlzLnByb2R1Y3RfZGF0YS52YXJpYW50cwogICAgICAgICAgICB0aGlzLnByb2R1Y3RfaW1hZ2VzID0gdGhpcy5wcm9kdWN0X2RhdGEuaW1hZ2VzCiAgICAgICAgICAgIHRoaXMucHJvZHVjdF9wcmljZSA9IHRoaXMudmFyaWFudHNbMF0ucHJpY2UKCiAgICAgICAgICAgIHRoaXMucHJvZHVjdF9kZXNjcmlwdGlvbiA9IHRoaXMucHJvZHVjdF9kYXRhLmJvZHlfaHRtbC5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywiIik7CgogICAgICAgICAgICBpZiAodGhpcy5wcm9kdWN0X2RhdGEub3B0aW9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gdGhpcy5wcm9kdWN0X2RhdGEub3B0aW9ucwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMub3B0aW9ucyk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJ1cGRhdGVkIik7CgogICAgICAgICAgfSkKICAgICAgICB9KQogICAgICAgIC50aGVuKCAoKSA9PiB7CiAgICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbigpewogICAgICAgICAgICAkKCcuc2xpZGVyJykuZmxpY2tpdHkoewogICAgICAgICAgICAgIGNvbnRhaW46IHRydWUsCiAgICAgICAgICAgICAgY2VsbEFsaWduOiAibGVmdCIKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pCiAgICAgICAgfSApCiAgICAgIH0sCiAgICAgIHNlbmRDYXJ0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5sb2coIlNFTkRJTkchIUAhISIpOwogICAgICAgIGxldCBxdWFudGl0eSA9ICQoJy5xdWFudGl0eScpLnZhbCgpOwogICAgICAgIGxldCBvcHRpb25zID0gW107CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkKCcub3B0aW9uLXNlbGVjdCcpLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBsZXQgdmFsID0gJCgnLm9wdGlvbi1zZWxlY3QnKVtpXS52YWx1ZQogICAgICAgICAgaWYgKHZhbCAhPSAiIikgewogICAgICAgICAgICBvcHRpb25zLnB1c2godmFsKQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoJ1BsZWFzZSBzZWxlY3Qgc2l6ZSBhbmQgY29sb3InKQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMubGVuZ3RoID09IDIpIHsKICAgICAgICB2YXIgcHJvZCA9IHRoaXMudmFyaWFudHMuZmluZCggeCA9PiB4Lm9wdGlvbjEgPT0gb3B0aW9uc1swXSAmJiB4Lm9wdGlvbjIgPT0gb3B0aW9uc1sxXSApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIHByb2QgPSB0aGlzLnZhcmlhbnRzLmZpbmQoIHggPT4geC5vcHRpb24xID09IG9wdGlvbnNbMF0gKQogICAgICB9CgogICAgICB0aGlzLmNhcnRfdXJsID0gdGhpcy5jYXJ0X3VybC5jb25jYXQoYC8ke3Byb2QuaWR9OiR7cXVhbnRpdHl9YCkKICAgICAgY29uc29sZS5sb2codGhpcy5jYXJ0X3VybCk7CgogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdGhpcy5jYXJ0X3VybAogICAgfQoKICAgIH0sCiAgICBjb21wb25lbnRzOiB7CiAgICAgICdwcm9kdWN0JzogewogICAgICAgIHByb3BzOiBbJ2hhbmRsZSddLAogICAgICAgIHRlbXBsYXRlOiBgPGgxPiB7eyBoYW5kbGUgfX0gIDwvaDE+YAogICAgICB9CiAgICB9CiAgfSkKCiAgY29uc29sZS5sb2codm0pOwoKfSApOwoKfSx7fV19LHt9LFsxXSk7Cg==\",\n      \"encoding\": \"base64\"\n    },\n    {\n      \"file\": \"bismuth.css\",\n      \"data\": \"LyogaHR0cDovL21leWVyd2ViLmNvbS9lcmljL3Rvb2xzL2Nzcy9yZXNldC8NCiAgIHYyLjAgfCAyMDExMDEyNg0KICAgTGljZW5zZTogbm9uZSAocHVibGljIGRvbWFpbikNCiovDQoNCmh0bWwsIGJvZHksIGRpdiwgc3BhbiwgYXBwbGV0LCBvYmplY3QsIGlmcmFtZSwNCmgxLCBoMiwgaDMsIGg0LCBoNSwgaDYsIHAsIGJsb2NrcXVvdGUsIHByZSwNCmEsIGFiYnIsIGFjcm9ueW0sIGFkZHJlc3MsIGJpZywgY2l0ZSwgY29kZSwNCmRlbCwgZGZuLCBlbSwgaW1nLCBpbnMsIGtiZCwgcSwgcywgc2FtcCwNCnNtYWxsLCBzdHJpa2UsIHN0cm9uZywgc3ViLCBzdXAsIHR0LCB2YXIsDQpiLCB1LCBpLCBjZW50ZXIsDQpkbCwgZHQsIGRkLCBvbCwgdWwsIGxpLA0KZmllbGRzZXQsIGZvcm0sIGxhYmVsLCBsZWdlbmQsDQp0YWJsZSwgY2FwdGlvbiwgdGJvZHksIHRmb290LCB0aGVhZCwgdHIsIHRoLCB0ZCwNCmFydGljbGUsIGFzaWRlLCBjYW52YXMsIGRldGFpbHMsIGVtYmVkLA0KZmlndXJlLCBmaWdjYXB0aW9uLCBmb290ZXIsIGhlYWRlciwgaGdyb3VwLA0KbWVudSwgbmF2LCBvdXRwdXQsIHJ1YnksIHNlY3Rpb24sIHN1bW1hcnksDQp0aW1lLCBtYXJrLCBhdWRpbywgdmlkZW8gew0KCW1hcmdpbjogMDsNCglwYWRkaW5nOiAwOw0KCWJvcmRlcjogMDsNCglmb250LXNpemU6IDEwMCU7DQoJZm9udDogaW5oZXJpdDsNCgl2ZXJ0aWNhbC1hbGlnbjogY2VudGVyOw0KfQ0KLyogSFRNTDUgZGlzcGxheS1yb2xlIHJlc2V0IGZvciBvbGRlciBicm93c2VycyAqLw0KYXJ0aWNsZSwgYXNpZGUsIGRldGFpbHMsIGZpZ2NhcHRpb24sIGZpZ3VyZSwNCmZvb3RlciwgaGVhZGVyLCBoZ3JvdXAsIG1lbnUsIG5hdiwgc2VjdGlvbiB7DQoJZGlzcGxheTogYmxvY2s7DQp9DQpib2R5IHsNCglsaW5lLWhlaWdodDogMTsNCn0NCm9sLCB1bCB7DQoJbGlzdC1zdHlsZTogbm9uZTsNCn0NCmJsb2NrcXVvdGUsIHEgew0KCXF1b3Rlczogbm9uZTsNCn0NCmJsb2NrcXVvdGU6YmVmb3JlLCBibG9ja3F1b3RlOmFmdGVyLA0KcTpiZWZvcmUsIHE6YWZ0ZXIgew0KCWNvbnRlbnQ6ICcnOw0KCWNvbnRlbnQ6IG5vbmU7DQp9DQp0YWJsZSB7DQoJYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsNCglib3JkZXItc3BhY2luZzogMDsNCn0NCg0KDQovKj09PT09PT09PT09PT09PT0gUmVzZXQgPT09PT09PT09PT09PT09PSovDQovKiEgbm9ybWFsaXplLmNzcyB2Ny4wLjAgfCBNSVQgTGljZW5zZSB8IGdpdGh1Yi5jb20vbmVjb2xhcy9ub3JtYWxpemUuY3NzICovDQovKiBEb2N1bWVudA0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCmJ1dHRvbixocixpbnB1dHtvdmVyZmxvdzp2aXNpYmxlfWltZyxsZWdlbmR7bWF4LXdpZHRoOjEwMCV9YXVkaW8sY2FudmFzLHByb2dyZXNzLHZpZGVve2Rpc3BsYXk6aW5saW5lLWJsb2NrfXByb2dyZXNzLHN1YixzdXB7dmVydGljYWwtYWxpZ246YmFzZWxpbmV9W3R5cGU9Y2hlY2tib3hdLFt0eXBlPXJhZGlvXSxsZWdlbmR7cGFkZGluZzowO2JveC1zaXppbmc6Ym9yZGVyLWJveH0qLDo6YWZ0ZXIsOjpiZWZvcmUsbGVnZW5ke2JveC1zaXppbmc6Ym9yZGVyLWJveH1hOmZvY3VzLGxlZ2VuZHtjb2xvcjppbmhlcml0fWJvZHksZm9ybXttYXJnaW46MH1odG1se2xpbmUtaGVpZ2h0OjEuMTU7LW1zLXRleHQtc2l6ZS1hZGp1c3Q6MTAwJTstd2Via2l0LXRleHQtc2l6ZS1hZGp1c3Q6MTAwJX1hcnRpY2xlLGFzaWRlLGRldGFpbHMsZmlnY2FwdGlvbixmaWd1cmUsZm9vdGVyLGhlYWRlcixtYWluLG1lbnUsbmF2LHNlY3Rpb257ZGlzcGxheTpibG9ja31oMXtmb250LXNpemU6MmVtO21hcmdpbjouNjdlbSAwfWZpZ3VyZXttYXJnaW46MWVtIDQwcHh9aHJ7Ym94LXNpemluZzpjb250ZW50LWJveDtoZWlnaHQ6MH1jb2RlLGtiZCxwcmUsc2FtcHtmb250LWZhbWlseTptb25vc3BhY2UsbW9ub3NwYWNlO2ZvbnQtc2l6ZToxZW19YXtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50Oy13ZWJraXQtdGV4dC1kZWNvcmF0aW9uLXNraXA6b2JqZWN0c31hYmJyW3RpdGxlXXtib3JkZXItYm90dG9tOm5vbmU7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTt0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lIGRvdHRlZH1iLHN0cm9uZ3tmb250LXdlaWdodDpib2xkZXJ9ZGZue2ZvbnQtc3R5bGU6aXRhbGljfW1hcmt7YmFja2dyb3VuZC1jb2xvcjojZmYwO2NvbG9yOiMwMDB9c21hbGx7Zm9udC1zaXplOjgwJX1zdWIsc3Vwe2ZvbnQtc2l6ZTo3NSU7bGluZS1oZWlnaHQ6MDtwb3NpdGlvbjpyZWxhdGl2ZX1zdWJ7Ym90dG9tOi0uMjVlbX1zdXB7dG9wOi0uNWVtfWF1ZGlvOm5vdChbY29udHJvbHNdKXtkaXNwbGF5Om5vbmU7aGVpZ2h0OjB9aW1ne2JvcmRlci1zdHlsZTpub25lfXN2Zzpub3QoOnJvb3Qpe292ZXJmbG93OmhpZGRlbn1idXR0b24saW5wdXQsb3B0Z3JvdXAsc2VsZWN0LHRleHRhcmVhe2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7Zm9udC1zaXplOjEwMCU7bGluZS1oZWlnaHQ6MS4xNTttYXJnaW46MH1idXR0b24sc2VsZWN0e3RleHQtdHJhbnNmb3JtOm5vbmV9W3R5cGU9cmVzZXRdLFt0eXBlPXN1Ym1pdF0sYnV0dG9uLGh0bWwgW3R5cGU9YnV0dG9uXXstd2Via2l0LWFwcGVhcmFuY2U6YnV0dG9ufVt0eXBlPWJ1dHRvbl06Oi1tb3otZm9jdXMtaW5uZXIsW3R5cGU9cmVzZXRdOjotbW96LWZvY3VzLWlubmVyLFt0eXBlPXN1Ym1pdF06Oi1tb3otZm9jdXMtaW5uZXIsYnV0dG9uOjotbW96LWZvY3VzLWlubmVye2JvcmRlci1zdHlsZTpub25lO3BhZGRpbmc6MH1bdHlwZT1idXR0b25dOi1tb3otZm9jdXNyaW5nLFt0eXBlPXJlc2V0XTotbW96LWZvY3VzcmluZyxbdHlwZT1zdWJtaXRdOi1tb3otZm9jdXNyaW5nLGJ1dHRvbjotbW96LWZvY3VzcmluZ3tvdXRsaW5lOkJ1dHRvblRleHQgZG90dGVkIDFweH1maWVsZHNldHtwYWRkaW5nOi4zNWVtIC43NWVtIC42MjVlbX1sZWdlbmR7ZGlzcGxheTp0YWJsZTt3aGl0ZS1zcGFjZTpub3JtYWx9dGV4dGFyZWF7b3ZlcmZsb3c6YXV0b31bdHlwZT1udW1iZXJdOjotd2Via2l0LWlubmVyLXNwaW4tYnV0dG9uLFt0eXBlPW51bWJlcl06Oi13ZWJraXQtb3V0ZXItc3Bpbi1idXR0b257aGVpZ2h0OmF1dG99W3R5cGU9c2VhcmNoXXstd2Via2l0LWFwcGVhcmFuY2U6dGV4dGZpZWxkO291dGxpbmUtb2Zmc2V0Oi0ycHh9W3R5cGU9c2VhcmNoXTo6LXdlYmtpdC1zZWFyY2gtY2FuY2VsLWJ1dHRvbixbdHlwZT1zZWFyY2hdOjotd2Via2l0LXNlYXJjaC1kZWNvcmF0aW9uey13ZWJraXQtYXBwZWFyYW5jZTpub25lfTo6LXdlYmtpdC1maWxlLXVwbG9hZC1idXR0b257LXdlYmtpdC1hcHBlYXJhbmNlOmJ1dHRvbjtmb250OmluaGVyaXR9c3VtbWFyeXtkaXNwbGF5Omxpc3QtaXRlbX1baGlkZGVuXSx0ZW1wbGF0ZXtkaXNwbGF5Om5vbmV9Ym9keSxidXR0b24saW5wdXQsc2VsZWN0LHRleHRhcmVhey13ZWJraXQtZm9udC1zbW9vdGhpbmc6YW50aWFsaWFzZWQ7LXdlYmtpdC10ZXh0LXNpemUtYWRqdXN0OjEwMCV9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCkZhc3QgVGFwIC8gZW5hYmxlcyBuby1kZWxheSB0YXBzIChGYXN0Q2xpY2stZXNxdWUpIG9uIHN1cHBvcnRpbmcgYnJvd3NlcnMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQphLCBidXR0b24sIFtyb2xlPSJidXR0b24iXSwgaW5wdXQsIGxhYmVsLCBzZWxlY3QsIHRleHRhcmVhIHsNCiAgdG91Y2gtYWN0aW9uOiBtYW5pcHVsYXRpb247DQp9DQovKj09PT09PT09PT09PT09PT0gQmlzbXV0aCBSZXNldHMgQ2xhc3NlcyA9PT09PT09PT09PT09PT09Ki8NCiosKjpiZWZvcmUsKjphZnRlcnsNCiAgLW1vei1ib3gtc2l6aW5nOmJvcmRlci1ib3g7DQogIC13ZWJraXQtYm94LXNpemluZzpib3JkZXItYm94Ow0KICBib3gtc2l6aW5nOmJvcmRlci1ib3gNCn0NCmh0bWwsIGJvZHl7DQogIHdpZHRoOjEwMCU7DQogIG1hcmdpbjowOw0KfQ0KaHRtbHsNCiAgcG9zaXRpb246cmVsYXRpdmU7DQogIGhlaWdodDoxMDAlOw0KfQ0KaW1nLCBmaWd1cmUsIGlmcmFtZXsNCiAgZGlzcGxheTpibG9jazsNCiAgbWF4LXdpZHRoOjEwMCU7DQogIC8vIGhlaWdodDphdXRvOw0KICBib3JkZXI6bm9uZTsNCiAgb3V0bGluZTpub25lDQp9DQp1bCB7DQogIHBhZGRpbmc6IDBweDsNCiAgbGlzdC1zdHlsZTogbm9uZTsNCn0NCmF7DQogIHBvc2l0aW9uOnJlbGF0aXZlOw0KICB3b3JkLXdyYXA6YnJlYWstd29yZDsNCiAgdGV4dC1kZWNvcmF0aW9uOm5vbmU7DQogIGJvcmRlcjpub25lOw0KICBvdXRsaW5lOm5vbmU7DQogIGN1cnNvcjpwb2ludGVyOw0KICB0cmFuc2l0aW9uOi4zczsNCn0NCg0KDQpib2R5ew0KICBvdmVyZmxvdzogaGlkZGVuOw0KfQ0KDQoNCiNhcHB7DQogICAgbWF4LXdpZHRoOiAxMDB2dzsNCiAgICBmb250LXNpemU6IDMwcHg7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KfQ0KDQoucHJvZHVjdC1jb250YWluZXJ7DQogIGJvcmRlcjogMnB4IHNvbGlkIGJsYWNrOw0KICBoZWlnaHQ6IDk5dmg7DQogIG1hcmdpbjogMTRweDsNCn0NCg0KLnNsaWRlcnsNCiAgbWF4LXdpZHRoOiAxMDAlOw0KICAvKiBtYXgtaGVpZ2h0OiA0MHZoOyAqLw0KfQ0KDQoucHJvZHVjdC1pbWFnZXsNCiAgbWF4LXdpZHRoOiAxMDB2dzsNCiAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkIGJsYWNrOw0KfQ0KDQouaG9yaXpvbnRhbC1jb250YWluZXJ7DQogIHdpZHRoOiAxMDAlOw0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDsNCiAgbWFyZ2luLXRvcDogNXJlbTsNCiAgcGFkZGluZzogMXJlbSAwOw0KfQ0KDQoucHJpY2UsIC5xdWFudGl0eSB7DQogIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrOw0KICB3aWR0aDogMTAwJTsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KDQoucHJvZHVjdC1kZXNjcmlwdGlvbnsNCiAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7DQogIG1heC1oZWlnaHQ6IDMwdmg7DQp9DQoNCi5ib3R0b20tY29udGFpbmVyew0KICB3aWR0aDogMTAwJTsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAvKiBwb3NpdGlvbjogYWJzb2x1dGU7DQogIGJvdHRvbTogNHJlbTsgKi8NCn0NCg0KDQoub3B0aW9uLXBhcmVudC1jb250YWluZXJ7DQogIGRpc3BsYXk6IGdyaWQ7DQogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDFmcjsNCn0=\",\n      \"encoding\": \"base64\"\n    }\n\n  ]\n}`
}



var postResponse = $.ajax(settings).then(function (response) {
  console.log(response);

    return response
})

return postResponse

}

export function postToTable(store_url, dep_id, product_handle){
  console.log('TRYING TO POST');

    var record = base('Table 1').create({
    "store_url": store_url,
    "deployment_id": dep_id,
    "product_handle": product_handle,
    "live": true
  }, function(err, record) {
      if (err) { console.error(err); return; }
      console.log(record.getId());
  });
}



export default { masterFetch, postToTable }
